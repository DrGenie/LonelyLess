<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>LonelyLessAustralia Decision Aid Tool</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-papNMzNnQn5iH+1G+FHu8SyuXHs6A1k+Ln7tK5qRo1l5eYm6Jzv+1pArJ7N4C9FfpRrmAgM3tYWd3FZ9jKz1Bw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Chart.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>LonelyLessAustralia Decision Aid Tool</h1>
      <p>This tool helps you evaluate programme configurations for reducing loneliness. It explains how costs and benefits are calculated so that users can understand the trade‐offs.</p>
    </header>

    <nav class="tabs" role="tablist">
      <button class="tablink active" role="tab" aria-selected="true" aria-controls="introTab" onclick="openTab('introTab', this)">
        <i class="fa-solid fa-info-circle"></i><span> Introduction</span>
      </button>
      <button class="tablink" role="tab" aria-selected="false" aria-controls="instructionsTab" onclick="openTab('instructionsTab', this)">
        <i class="fa-solid fa-circle-question"></i><span> Instructions</span>
      </button>
      <button class="tablink" role="tab" aria-selected="false" aria-controls="attributesTab" onclick="openTab('attributesTab', this)">
        <i class="fa-solid fa-list"></i><span> Attributes</span>
      </button>
      <button class="tablink" role="tab" aria-selected="false" aria-controls="inputsTab" onclick="openTab('inputsTab', this)">
        <i class="fa-solid fa-sliders"></i><span> Inputs</span>
      </button>
      <button class="tablink" role="tab" aria-selected="false" aria-controls="wtpTab" onclick="openTab('wtpTab', this)">
        <i class="fa-solid fa-chart-bar"></i><span> WTP Results</span>
      </button>
      <button class="tablink" role="tab" aria-selected="false" aria-controls="probTab" onclick="openTab('probTab', this)">
        <i class="fa-solid fa-chart-line"></i><span> Predicted Programme Uptake</span>
      </button>
      <button class="tablink" role="tab" aria-selected="false" aria-controls="costsTab" onclick="openTab('costsTab', this)">
        <i class="fa-solid fa-calculator"></i><span> Costs &amp; Benefits</span>
      </button>
      <button class="tablink" role="tab" aria-selected="false" aria-controls="scenariosTab" onclick="openTab('scenariosTab', this)">
        <i class="fa-solid fa-folder-open"></i><span> Scenarios</span>
      </button>
    </nav>

    <!-- Introduction Tab -->
    <section id="introTab" class="tabcontent" tabindex="0" style="display: block;">
      <div class="intro-box">
        <p>
          Loneliness affects over five million Australians, particularly older adults, causing significant health and economic challenges. This tool uses discrete choice experiment estimates to predict programme uptake probabilities, enabling personalised services based on the attributes older adults value most.
        </p>
        <ul>
          <li><strong>Instructions</strong> – Step-by-step guidance.</li>
          <li><strong>Attributes</strong> – Detailed explanation of programme features (hover over info icons for extra details).</li>
          <li><strong>Inputs</strong> – Configure your scenario parameters using user-friendly level cards.</li>
          <li><strong>WTP Results</strong> – View charts showing willingness-to-pay estimates.</li>
          <li><strong>Predicted Programme Uptake</strong> – See the predicted uptake percentage and suggestions for improvements.</li>
          <li><strong>Costs &amp; Benefits</strong> – Analyse detailed cost components and QALY-based benefits, with interactive sliders, pop-up info boxes and educational summaries.</li>
          <li><strong>Scenarios</strong> – Save, compare and export various configurations.</li>
        </ul>
      </div>
    </section>

    <!-- Instructions Tab -->
    <section id="instructionsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>How to Use This Tool</h4>
        <ol>
          <li style="margin-left: 20px;">Review the <strong>Attributes</strong> tab to understand each programme feature. Hover over the info icons to view extra details.</li>
          <li style="margin-left: 20px;">Configure your scenario in the <strong>Inputs</strong> tab using the level cards (hover over the info buttons for instructions).</li>
          <li style="margin-left: 20px;">Click “Calculate &amp; View Results” to update charts and the cost-benefit analysis.</li>
          <li style="margin-left: 20px;">Examine the <strong>WTP Results</strong> tab to see the monetary value respondents assign to each attribute.</li>
          <li style="margin-left: 20px;">Check the <strong>Predicted Programme Uptake</strong> tab to view the predicted uptake percentage and suggestions for adjustments.</li>
          <li style="margin-left: 20px;">Review the <strong>Costs &amp; Benefits</strong> tab for an interactive cost breakdown with educational summaries explaining key modelling assumptions.</li>
          <li style="margin-left: 20px;">Save and compare different scenarios in the <strong>Scenarios</strong> tab or export the results to PDF.</li>
        </ol>
      </div>
    </section>

    <!-- Attributes Tab -->
    <section id="attributesTab" class="tabcontent" tabindex="0">
      <h2>Key Attributes</h2>
      <div class="attributes-list">
        <!-- (Attribute cards as before; unchanged) -->
        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <svg width="24" height="24" fill="#2980b9" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="#2980b9" stroke-width="2" fill="none"/>
              <path d="M10 15l-3-3 1.4-1.4 1.6 1.6L15 7l1.4 1.4-6.4 6.4z" fill="#2980b9"/>
            </svg>
            <div class="tooltip" role="tooltip">
              The out-of-pocket fee (in AUD) participants must pay each time they attend.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Cost per session</h4>
            <p>The out-of-pocket fee (AUD) participants must pay each time they attend.</p>
          </div>
        </div>
        <!-- Additional attribute cards omitted for brevity -->
      </div>
    </section>

    <!-- Inputs Tab (Level Card Layout) -->
    <section id="inputsTab" class="tabcontent" tabindex="0">
      <div class="input-card">
        <h2>Programme Inputs</h2>
        <p>Set up your scenario using the controls below. Hover over the info icons for guidance.</p>
        <div class="form-grid">
          <div class="form-item">
            <label for="state_select">
              <i class="fa-solid fa-map-marker-alt"></i> State:
              <button class="info-button" aria-label="Choose your state to adjust for cost-of-living differences.">
                <i class="fa-solid fa-info-circle"></i>
              </button>
              <span class="tooltip-text">Choose your state to adjust for cost-of-living differences.</span>
            </label>
            <select id="state_select">
              <option value="">None</option>
              <option value="NSW">New South Wales</option>
              <option value="VIC">Victoria</option>
              <option value="QLD">Queensland</option>
              <option value="WA">Western Australia</option>
              <option value="SA">South Australia</option>
              <option value="TAS">Tasmania</option>
              <option value="ACT">Australian Capital Territory</option>
              <option value="NT">Northern Territory</option>
            </select>
            <label for="adjustCosts">
              <i class="fa-solid fa-sync-alt"></i> Adjust for Cost of Living?
              <button class="info-button" aria-label="Select Yes to apply cost-of-living multipliers for the chosen state.">
                <i class="fa-solid fa-info-circle"></i>
              </button>
              <span class="tooltip-text">Select Yes to apply cost-of-living multipliers for the chosen state.</span>
            </label>
            <select id="adjustCosts">
              <option value="no">No</option>
              <option value="yes">Yes</option>
            </select>
          </div>
          <div class="form-item">
            <label for="costSlider">
              <i class="fa-solid fa-dollar-sign"></i> Cost per Session (AUD):
              <button class="info-button" aria-label="Use the slider to set the base cost per session.">
                <i class="fa-solid fa-info-circle"></i>
              </button>
              <span class="tooltip-text">Use the slider to set the base cost per session.</span>
            </label>
            <input type="range" id="costSlider" min="0" max="100" step="1" value="50" oninput="updateCostDisplay(this.value)" />
            <span id="costLabel">50</span>
          </div>
          <div class="form-item">
            <label>
              <i class="fa-solid fa-location-arrow"></i> Accessibility:
            </label>
            <label>
              <input type="checkbox" id="localCheck" /> Local Area (12 km)
            </label>
            <label>
              <input type="checkbox" id="widerCheck" /> Wider Community (50+ km)
            </label>
          </div>
          <div class="form-item">
            <label>
              <i class="fa-solid fa-calendar-alt"></i> Frequency:
            </label>
            <label>
              <input type="checkbox" id="weeklyCheck" /> Weekly
            </label>
            <label>
              <input type="checkbox" id="monthlyCheck" /> Monthly
            </label>
          </div>
          <div class="form-item">
            <label>
              <i class="fa-solid fa-video"></i> Method:
            </label>
            <label>
              <input type="checkbox" id="virtualCheck" /> Virtual
            </label>
            <label>
              <input type="checkbox" id="hybridCheck" /> Hybrid (In-person &amp; Virtual)
            </label>
          </div>
          <div class="form-item">
            <label>
              <i class="fa-solid fa-clock"></i> Duration:
            </label>
            <label>
              <input type="checkbox" id="twoHCheck" /> 2-hour Session
            </label>
            <label>
              <input type="checkbox" id="fourHCheck" /> 4-hour Session
            </label>
          </div>
          <div class="form-item">
            <label>
              <i class="fa-solid fa-hands-helping"></i> Support Programme:
            </label>
            <label>
              <input type="checkbox" id="commCheck" /> Community Engagement
            </label>
            <label>
              <input type="checkbox" id="psychCheck" /> Counselling
            </label>
            <label>
              <input type="checkbox" id="vrCheck" /> Virtual Reality
            </label>
          </div>
        </div>
        <div class="buttons-row">
          <button type="button" onclick="openSingleScenario()">Calculate &amp; View Results</button>
        </div>
      </div>
    </section>

    <!-- WTP Results Tab -->
    <section id="wtpTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Willingness to Pay (WTP) Results</h4>
        <p>
          The willingness-to-pay (WTP) for each programme attribute is calculated by taking the ratio of the attribute’s coefficient to the negative of the cost coefficient. This metric quantifies the monetary value respondents place on each programme attribute, holding other factors constant.
        </p>
        <p>
          For example, among the programme types, community engagement is the most highly valued, with a WTP of A$14.47 (SE=3.31, p &lt; 0.001). This shows older adults are willing to pay an additional A$14.47 for community-based programmes, compared to the reference peer support scenario.
        </p>
        <div class="buttons-row">
          <button onclick="renderWTPChart()">Show WTP Charts</button>
        </div>
        <div class="chart-grid">
          <div class="chart-box">
            <h3>WTP (A$)</h3>
            <canvas id="wtpChartMain"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Predicted Programme Uptake Tab -->
    <section id="probTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Predicted Programme Uptake</h4>
        <p>
          Click “Show Probability Plot” to compute a new bar chart based on your Inputs. The chart displays the predicted uptake percentage. Depending on whether the uptake is below 30%, between 30–70%, or above 70%, the tool provides intuitive suggestions for adjusting programme cost, enhancing accessibility, or increasing interaction frequency.
        </p>
        <div class="buttons-row">
          <button onclick="renderProbChart()">Show Probability Plot</button>
        </div>
        <div class="chart-grid">
          <div class="chart-box">
            <h3>Uptake Probability</h3>
            <canvas id="probChartMain"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Costs & Benefits Tab -->
    <section id="costsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Costs &amp; Benefits Analysis</h4>
        <div class="qaly-selector">
          <label for="qalySelect">Select QALY Gain Scenario:</label>
          <select id="qalySelect" onchange="renderCostsBenefits()">
            <option value="low">Low (0.02 QALYs)</option>
            <option value="moderate" selected>Moderate (0.05 QALYs)</option>
            <option value="high">High (0.1 QALYs)</option>
          </select>
        </div>
        <div id="costsBenefitsResults">
          <!-- Combined Cost-Benefit Chart and summary will be rendered here -->
        </div>
        <div class="modelling-assumptions">
          <h3><i class="fa-solid fa-lightbulb"></i> Modelling Assumptions</h3>
          <p>
            Our analysis uses interactive cost sliders, pop-up info boxes and brief educational summaries to explain how costs and benefits are calculated. Hover over the info icon <i class="fa-solid fa-info-circle tooltip" data-tooltip="Fixed costs include advertisement, printing, postage, administrative personnel, training, on-costs, facilitator salaries, material costs, venue hire, session time and travel; benefits are calculated based on QALY gains multiplied by A$50,000."></i> for further details.
          </p>
        </div>
        <div class="cost-icons">
          <button class="buttons-row" onclick="toggleCostBreakdown()">Cost Breakdown</button>
          <button class="buttons-row" onclick="toggleBenefitsAnalysis()">Benefits Analysis</button>
        </div>
        <div id="detailedCostBreakdown" class="cost-cards" style="display:none;">
          <!-- All cost components as cards -->
          <div class="cost-card">
            <h4><i class="fa-solid fa-newspaper"></i> Advertisements in Local Press</h4>
            <p><strong>Value:</strong> A$2978.80</p>
            <p><strong>Quantity:</strong> 2</p>
            <p><strong>Unit Cost:</strong> A$1489.40</p>
            <p><strong>Total Cost:</strong> A$2978.80</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-print"></i> Printing of Leaflets</h4>
            <p><strong>Value:</strong> A$0.12</p>
            <p><strong>Quantity:</strong> 10000</p>
            <p><strong>Unit Cost:</strong> A$0.12</p>
            <p><strong>Total Cost:</strong> A$1200.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-envelope"></i> Parcel and Postage of Leaflets</h4>
            <p><strong>Value:</strong> A$0.15</p>
            <p><strong>Quantity:</strong> 10000</p>
            <p><strong>Unit Cost:</strong> A$0.15</p>
            <p><strong>Total Cost:</strong> A$1470.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-user"></i> Administrative Personnel</h4>
            <p><strong>Value:</strong> A$49.99</p>
            <p><strong>Quantity:</strong> 10</p>
            <p><strong>Unit Cost:</strong> A$49.99</p>
            <p><strong>Total Cost:</strong> A$499.90</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-chalkboard-teacher"></i> Trainer Cost for 5-hour Training Sessions</h4>
            <p><strong>Value:</strong> A$223.86</p>
            <p><strong>Quantity:</strong> 100</p>
            <p><strong>Unit Cost:</strong> A$223.86</p>
            <p><strong>Total Cost:</strong> A$22386.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-percent"></i> On-Costs (30%)</h4>
            <p><strong>Value:</strong> A$44.77</p>
            <p><strong>Quantity:</strong> 100</p>
            <p><strong>Unit Cost:</strong> A$44.77</p>
            <p><strong>Total Cost:</strong> A$4477.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-user-tie"></i> Facilitator Salaries (12 sessions x 2 h)</h4>
            <p><strong>Value:</strong> A$100.00</p>
            <p><strong>Quantity:</strong> 100</p>
            <p><strong>Unit Cost:</strong> A$100.00</p>
            <p><strong>Total Cost:</strong> A$10000.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-box"></i> Material Costs</h4>
            <p><strong>Value:</strong> A$50.00</p>
            <p><strong>Quantity:</strong> 100</p>
            <p><strong>Unit Cost:</strong> A$50.00</p>
            <p><strong>Total Cost:</strong> A$5000.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-building"></i> Venue Hire</h4>
            <p><strong>Value:</strong> A$15.00</p>
            <p><strong>Quantity:</strong> 100</p>
            <p><strong>Unit Cost:</strong> A$15.00</p>
            <p><strong>Total Cost:</strong> A$3000.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-clock"></i> Time Cost for Sessions</h4>
            <p><strong>Value:</strong> A$20.00</p>
            <p><strong>Quantity:</strong> 250</p>
            <p><strong>Unit Cost:</strong> A$20.00</p>
            <p><strong>Total Cost:</strong> A$5000.00</p>
          </div>
          <div class="cost-card">
            <h4><i class="fa-solid fa-road"></i> Travel Costs</h4>
            <p><strong>Value:</strong> A$10.00</p>
            <p><strong>Quantity:</strong> 250</p>
            <p><strong>Unit Cost:</strong> A$10.00</p>
            <p><strong>Total Cost:</strong> A$2500.00</p>
          </div>
        </div>
        <div id="detailedBenefitsAnalysis" class="cost-cards" style="display:none;">
          <div class="cost-card">
            <h4><i class="fa-solid fa-hand-holding-dollar"></i> QALY Benefits</h4>
            <p>Calculated as: (Participants × QALY per Participant) × A$50,000.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Scenarios Tab -->
    <section id="scenariosTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Saved Scenarios</h4>
        <p>Below are the scenarios you have saved. Each row shows the input values along with the computed predicted uptake and net benefit.</p>
        <div class="buttons-row">
          <button onclick="saveScenario()">Save Current Scenario</button>
          <button onclick="openComparison()">Compare &amp; Export to PDF</button>
        </div>
        <div class="filter-options">
          <label for="filterSelect">Filter Scenarios:</label>
          <select id="filterSelect">
            <option value="all">All</option>
          </select>
        </div>
        <div class="table-container">
          <table id="scenarioTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>State</th>
                <th>Cost Adjust?</th>
                <th>Cost (AUD)</th>
                <th>Local?</th>
                <th>Wider?</th>
                <th>Weekly?</th>
                <th>Monthly?</th>
                <th>Virtual?</th>
                <th>Hybrid?</th>
                <th>2-Hour?</th>
                <th>4-Hour?</th>
                <th>Community?</th>
                <th>Counselling?</th>
                <th>VR?</th>
                <th>Uptake (%)</th>
                <th>Net Benefit (A$)</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <footer>
      <p>&copy; 2025 LonelyLessAustralia. All Rights Reserved.<br />Mesfin Genie, Newcastle Business School, The University of Newcastle, Australia</p>
    </footer>
  </div>
  <script src="script.js"></script>
</body>
</html>
